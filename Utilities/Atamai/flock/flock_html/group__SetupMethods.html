<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Flock: Connecting to the Flock</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">Globals</a></div>
<h1>Connecting to the Flock</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SetupMethods.html#ga0">fbDeviceName</a> (int i)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">fbird *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SetupMethods.html#ga1">fbNew</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SetupMethods.html#ga2">fbDelete</a> (fbird *fb)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SetupMethods.html#ga3">fbOpen</a> (fbird *fb, const char *device, int baud, int mode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SetupMethods.html#ga4">fbClose</a> (fbird *fb)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SetupMethods.html#ga5">fbReset</a> (fbird *fb)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
The flock of birds must be connected to one of the serial ports on the computer. The device name for the serial ports are different for different operating systems, the <a class="el" href="group__SetupMethods.html#ga0">fbDeviceName()</a> function can be used to generate an appropriate device name for the host OS.<p>
The <code>fbird</code> data structure stores all of the information that is needed by the host computer in order to maintain communication with the flock. This includes information about the flock status as well as copies of the most recent data records from the flock. The contents of this structure cannot be accessed directly. <hr><h2>Function Documentation</h2>
<a class="anchor" name="ga0" doxytag="flock.h::fbDeviceName"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char * fbDeviceName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>i</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function returns a serial port device name that is appropriate for whatever operating system this code was compiled on.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>i</em>&nbsp;</td><td>an integer between 0 and 3 </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>a serial port device name, or NULL if <em>i</em> is out of range </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga1" doxytag="flock.h::fbNew"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">fbird * fbNew           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Allocate an initialized fbird structure that can be used to communicating with the flock.<p>
<dl compact><dt><b>Returns:</b></dt><dd>pointer to a new fbird structure </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga2" doxytag="flock.h::fbDelete"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void fbDelete           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">fbird *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>fb</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Release all computer resources associated with a flock structure. This will terminate communication with the flock before the flock structure is deallocated.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fb</em>&nbsp;</td><td>pointer to an fbird structure created with <a class="el" href="group__SetupMethods.html#ga1">fbNew()</a> </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga3" doxytag="flock.h::fbOpen"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int fbOpen           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">fbird *&nbsp;</td>
          <td class="mdname" nowrap> <em>fb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>device</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>baud</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>mode</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Open communication between the computer and the flock. This will also probe the flock for information such as the addressing mode. The serial port is set up to do XON/XOFF handshaking, and the RTS line is set to low.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fb</em>&nbsp;</td><td>pointer to an fbird structure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>device</em>&nbsp;</td><td>a valid serial port device name (see <a class="el" href="group__SetupMethods.html#ga0">fbDeviceName()</a>) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>baud</em>&nbsp;</td><td>the baud rate for the flock, either as the actual desired baud rate or as one of the following constants: FB_2400, FB_4800, FB_9600, FB_19200, FB_38400, FB_57600, FB_115200 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mode</em>&nbsp;</td><td>the threading mode, which should be one of:<ul>
<li>FB_NOTHREAD: disable multithreading</li><li>FB_THREAD: enable threading</li><li>FB_NONBLOCK: enable threading and allow duplicate records</li></ul>
</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>zero if <a class="el" href="group__SetupMethods.html#ga3">fbOpen()</a> was successful, or an error code otherwise (use <a class="el" href="group__ErrorMethods.html#ga1">fbGetErrorMessage()</a> to get a text error description)</dd></dl>
If it is unkown which serial port the flock is plugged into or what baud rate the flock is set to, then <a class="el" href="group__SetupMethods.html#ga3">fbOpen()</a> can be called repeatedly with different serial port names and baud rates in order to probe for the flock.<p>
The threading mode used is critical to the performance of communication with the flock. The flock is usually used in stream mode, which means that it is continuously sending data record to the computer at a rate of 100Hz. The threading mode determines how the computer manages to catch these data records and transfer the information to your application.<p>
In FB_NOTHREAD mode, your application is responsibe for calling <a class="el" href="group__DataMethods.html#ga0">fbUpdate()</a> at least 100 times per second during stream mode. If the application is not able to do so, then the serial port buffer will fill up and data records will become stale or might even be corrupted. It is, however, safe to use FB_NOTHREAD mode if only point mode data collection is used.<p>
In FB_THREAD mode, a separate thread is spawned that listens to the serial port while your application runs. Each time your application calls <a class="el" href="group__DataMethods.html#ga0">fbUpdate()</a> the most recent data record received from the flock is returned. If a new data record has not been recieved from the flock since the last time <a class="el" href="group__DataMethods.html#ga0">fbUpdate()</a> was called, then <a class="el" href="group__DataMethods.html#ga0">fbUpdate()</a> will not return until a fresh data record is transmitted from the flock.<p>
The FB_NONBLOCK mode is almost identical to FB_THREAD mode, except that a call to <a class="el" href="group__DataMethods.html#ga0">fbUpdate()</a> will always return immediately even if no new information has been recieved since the last call to <a class="el" href="group__DataMethods.html#ga0">fbUpdate()</a>. This means that a <a class="el" href="group__DataMethods.html#ga0">fbUpdate()</a> call might return exactly the same information as the previous <a class="el" href="group__DataMethods.html#ga0">fbUpdate()</a>.     </td>
  </tr>
</table>
<a class="anchor" name="ga4" doxytag="flock.h::fbClose"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void fbClose           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">fbird *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>fb</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Shut down the flock and close communication.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fb</em>&nbsp;</td><td>pointer to an fbird structure </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga5" doxytag="flock.h::fbReset"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void fbReset           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">fbird *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>fb</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Reset the bird that is connected to the serial port by toggling the RTS line.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fb</em>&nbsp;</td><td>pointer to an fbird structure</td></tr>
  </table>
</dl>
Note that this does not reset the whole flock. After <a class="el" href="group__SetupMethods.html#ga5">fbReset()</a> is called, <a class="el" href="group__FlockMethods.html#ga0">fbFBBReset()</a> can be called to reset the other birds.     </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Thu Jan 12 16:38:31 2006 for Flock by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
